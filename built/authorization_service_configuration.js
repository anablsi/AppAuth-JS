"use strict";
/*
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the
 * License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var xhr_1 = require("./xhr");
/**
 * OpenIdConnect Issuer Configs
 */
var OpenIdIssuerConfigs = /** @class */ (function () {
    function OpenIdIssuerConfigs(url, prms) {
        this.url = url;
        this.prms = prms;
    }
    return OpenIdIssuerConfigs;
}());
exports.OpenIdIssuerConfigs = OpenIdIssuerConfigs;
/**
 * The standard base path for well-known resources on domains.
 * See https://tools.ietf.org/html/rfc5785 for more information.
 */
var WELL_KNOWN_PATH = '.well-known';
/**
 * The standard resource under the well known path at which an OpenID Connect
 * discovery document can be found under an issuer's base URI.
 */
var OPENID_CONFIGURATION = 'openid-configuration';
/**
 * Configuration details required to interact with an authorization service.
 *
 * More information at https://openid.net/specs/openid-connect-discovery-1_0-17.html
 */
var AuthorizationServiceConfiguration = /** @class */ (function () {
    function AuthorizationServiceConfiguration(request) {
        this.authorizationEndpoint = request.authorization_endpoint;
        this.tokenEndpoint = request.token_endpoint;
        this.revocationEndpoint = request.revocation_endpoint;
        this.userInfoEndpoint = request.userinfo_endpoint;
        this.endSessionEndpoint = request.end_session_endpoint;
    }
    AuthorizationServiceConfiguration.prototype.toJson = function () {
        return {
            authorization_endpoint: this.authorizationEndpoint,
            token_endpoint: this.tokenEndpoint,
            revocation_endpoint: this.revocationEndpoint,
            end_session_endpoint: this.endSessionEndpoint,
            userinfo_endpoint: this.userInfoEndpoint
        };
    };
    AuthorizationServiceConfiguration.fetchFromIssuer = function (openIdIssuerConfigs, requestor) {
        var openIdIssuerUrl = (typeof openIdIssuerConfigs === 'string') ? openIdIssuerConfigs : openIdIssuerConfigs.url;
        var openIdIssuerPrms = (typeof openIdIssuerConfigs === 'string') ? null : openIdIssuerConfigs.prms;
        var fullUrl = openIdIssuerUrl + "/" + WELL_KNOWN_PATH + "/" + OPENID_CONFIGURATION + (openIdIssuerPrms == null ? '' : '?' + openIdIssuerPrms);
        var requestorToUse = requestor || new xhr_1.JQueryRequestor();
        return requestorToUse
            .xhr({ url: fullUrl, dataType: 'json', method: 'GET' })
            .then(function (json) { return new AuthorizationServiceConfiguration(json); });
    };
    return AuthorizationServiceConfiguration;
}());
exports.AuthorizationServiceConfiguration = AuthorizationServiceConfiguration;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aG9yaXphdGlvbl9zZXJ2aWNlX2NvbmZpZ3VyYXRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvYXV0aG9yaXphdGlvbl9zZXJ2aWNlX2NvbmZpZ3VyYXRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7R0FZRzs7QUFJSCw2QkFBaUQ7QUFFakQ7O0dBRUc7QUFDSDtJQUNFLDZCQUFtQixHQUFXLEVBQVMsSUFBWTtRQUFoQyxRQUFHLEdBQUgsR0FBRyxDQUFRO1FBQVMsU0FBSSxHQUFKLElBQUksQ0FBUTtJQUFHLENBQUM7SUFDekQsMEJBQUM7QUFBRCxDQUFDLEFBRkQsSUFFQztBQUZZLGtEQUFtQjtBQWVoQzs7O0dBR0c7QUFDSCxJQUFNLGVBQWUsR0FBRyxhQUFhLENBQUM7QUFFdEM7OztHQUdHO0FBQ0gsSUFBTSxvQkFBb0IsR0FBRyxzQkFBc0IsQ0FBQztBQUVwRDs7OztHQUlHO0FBQ0g7SUFPRSwyQ0FBWSxPQUE4QztRQUN4RCxJQUFJLENBQUMscUJBQXFCLEdBQUcsT0FBTyxDQUFDLHNCQUFzQixDQUFDO1FBQzVELElBQUksQ0FBQyxhQUFhLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQztRQUM1QyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsT0FBTyxDQUFDLG1CQUFtQixDQUFDO1FBQ3RELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxPQUFPLENBQUMsaUJBQWlCLENBQUM7UUFDbEQsSUFBSSxDQUFDLGtCQUFrQixHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQztJQUN6RCxDQUFDO0lBRUQsa0RBQU0sR0FBTjtRQUNFLE9BQU87WUFDTCxzQkFBc0IsRUFBRSxJQUFJLENBQUMscUJBQXFCO1lBQ2xELGNBQWMsRUFBRSxJQUFJLENBQUMsYUFBYTtZQUNsQyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsa0JBQWtCO1lBQzVDLG9CQUFvQixFQUFFLElBQUksQ0FBQyxrQkFBa0I7WUFDN0MsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLGdCQUFnQjtTQUN6QyxDQUFDO0lBQ0osQ0FBQztJQVFNLGlEQUFlLEdBQXRCLFVBQXVCLG1CQUErQyxFQUFFLFNBQXFCO1FBRTNGLElBQU0sZUFBZSxHQUNqQixDQUFDLE9BQU8sbUJBQW1CLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUM7UUFDOUYsSUFBTSxnQkFBZ0IsR0FDbEIsQ0FBQyxPQUFPLG1CQUFtQixLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQztRQUVoRixJQUFNLE9BQU8sR0FBTSxlQUFlLFNBQUksZUFBZSxTQUFJLG9CQUFvQixJQUN6RSxnQkFBZ0IsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLGdCQUFnQixDQUFFLENBQUM7UUFFN0QsSUFBTSxjQUFjLEdBQUcsU0FBUyxJQUFJLElBQUkscUJBQWUsRUFBRSxDQUFDO1FBRTFELE9BQU8sY0FBYzthQUNoQixHQUFHLENBQXdDLEVBQUMsR0FBRyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUMsQ0FBQzthQUMzRixJQUFJLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxJQUFJLGlDQUFpQyxDQUFDLElBQUksQ0FBQyxFQUEzQyxDQUEyQyxDQUFDLENBQUM7SUFDakUsQ0FBQztJQUNILHdDQUFDO0FBQUQsQ0FBQyxBQS9DRCxJQStDQztBQS9DWSw4RUFBaUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdFxuICogaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZVxuICogTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXJcbiAqIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtBdXRofSBmcm9tICdoYXBpJztcblxuaW1wb3J0IHtKUXVlcnlSZXF1ZXN0b3IsIFJlcXVlc3Rvcn0gZnJvbSAnLi94aHInO1xuXG4vKipcbiAqIE9wZW5JZENvbm5lY3QgSXNzdWVyIENvbmZpZ3NcbiAqL1xuZXhwb3J0IGNsYXNzIE9wZW5JZElzc3VlckNvbmZpZ3Mge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgdXJsOiBzdHJpbmcsIHB1YmxpYyBwcm1zOiBzdHJpbmcpIHt9XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyBBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb24gYXMgYSBKU09OIG9iamVjdC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb25Kc29uIHtcbiAgYXV0aG9yaXphdGlvbl9lbmRwb2ludDogc3RyaW5nO1xuICB0b2tlbl9lbmRwb2ludDogc3RyaW5nO1xuICByZXZvY2F0aW9uX2VuZHBvaW50OiBzdHJpbmc7XG4gIGVuZF9zZXNzaW9uX2VuZHBvaW50Pzogc3RyaW5nO1xuICB1c2VyaW5mb19lbmRwb2ludD86IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgc3RhbmRhcmQgYmFzZSBwYXRoIGZvciB3ZWxsLWtub3duIHJlc291cmNlcyBvbiBkb21haW5zLlxuICogU2VlIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM1Nzg1IGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICovXG5jb25zdCBXRUxMX0tOT1dOX1BBVEggPSAnLndlbGwta25vd24nO1xuXG4vKipcbiAqIFRoZSBzdGFuZGFyZCByZXNvdXJjZSB1bmRlciB0aGUgd2VsbCBrbm93biBwYXRoIGF0IHdoaWNoIGFuIE9wZW5JRCBDb25uZWN0XG4gKiBkaXNjb3ZlcnkgZG9jdW1lbnQgY2FuIGJlIGZvdW5kIHVuZGVyIGFuIGlzc3VlcidzIGJhc2UgVVJJLlxuICovXG5jb25zdCBPUEVOSURfQ09ORklHVVJBVElPTiA9ICdvcGVuaWQtY29uZmlndXJhdGlvbic7XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBkZXRhaWxzIHJlcXVpcmVkIHRvIGludGVyYWN0IHdpdGggYW4gYXV0aG9yaXphdGlvbiBzZXJ2aWNlLlxuICpcbiAqIE1vcmUgaW5mb3JtYXRpb24gYXQgaHR0cHM6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWRpc2NvdmVyeS0xXzAtMTcuaHRtbFxuICovXG5leHBvcnQgY2xhc3MgQXV0aG9yaXphdGlvblNlcnZpY2VDb25maWd1cmF0aW9uIHtcbiAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBzdHJpbmc7XG4gIHRva2VuRW5kcG9pbnQ6IHN0cmluZztcbiAgcmV2b2NhdGlvbkVuZHBvaW50OiBzdHJpbmc7XG4gIHVzZXJJbmZvRW5kcG9pbnQ/OiBzdHJpbmc7XG4gIGVuZFNlc3Npb25FbmRwb2ludD86IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihyZXF1ZXN0OiBBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb25Kc29uKSB7XG4gICAgdGhpcy5hdXRob3JpemF0aW9uRW5kcG9pbnQgPSByZXF1ZXN0LmF1dGhvcml6YXRpb25fZW5kcG9pbnQ7XG4gICAgdGhpcy50b2tlbkVuZHBvaW50ID0gcmVxdWVzdC50b2tlbl9lbmRwb2ludDtcbiAgICB0aGlzLnJldm9jYXRpb25FbmRwb2ludCA9IHJlcXVlc3QucmV2b2NhdGlvbl9lbmRwb2ludDtcbiAgICB0aGlzLnVzZXJJbmZvRW5kcG9pbnQgPSByZXF1ZXN0LnVzZXJpbmZvX2VuZHBvaW50O1xuICAgIHRoaXMuZW5kU2Vzc2lvbkVuZHBvaW50ID0gcmVxdWVzdC5lbmRfc2Vzc2lvbl9lbmRwb2ludDtcbiAgfVxuXG4gIHRvSnNvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aG9yaXphdGlvbl9lbmRwb2ludDogdGhpcy5hdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICB0b2tlbl9lbmRwb2ludDogdGhpcy50b2tlbkVuZHBvaW50LFxuICAgICAgcmV2b2NhdGlvbl9lbmRwb2ludDogdGhpcy5yZXZvY2F0aW9uRW5kcG9pbnQsXG4gICAgICBlbmRfc2Vzc2lvbl9lbmRwb2ludDogdGhpcy5lbmRTZXNzaW9uRW5kcG9pbnQsXG4gICAgICB1c2VyaW5mb19lbmRwb2ludDogdGhpcy51c2VySW5mb0VuZHBvaW50XG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBmZXRjaEZyb21Jc3N1ZXIob3BlbklkSXNzdWVyVXJsOiBzdHJpbmcsIHJlcXVlc3Rvcj86IFJlcXVlc3Rvcik6XG4gICAgICBQcm9taXNlPEF1dGhvcml6YXRpb25TZXJ2aWNlQ29uZmlndXJhdGlvbj47XG5cbiAgc3RhdGljIGZldGNoRnJvbUlzc3VlcihvcGVuSWRJc3N1ZXJDb25maWdzOiBPcGVuSWRJc3N1ZXJDb25maWdzLCByZXF1ZXN0b3I/OiBSZXF1ZXN0b3IpOlxuICAgICAgUHJvbWlzZTxBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb24+O1xuXG4gIHN0YXRpYyBmZXRjaEZyb21Jc3N1ZXIob3BlbklkSXNzdWVyQ29uZmlnczogT3BlbklkSXNzdWVyQ29uZmlnc3xzdHJpbmcsIHJlcXVlc3Rvcj86IFJlcXVlc3Rvcik6XG4gICAgICBQcm9taXNlPEF1dGhvcml6YXRpb25TZXJ2aWNlQ29uZmlndXJhdGlvbj4ge1xuICAgIGNvbnN0IG9wZW5JZElzc3VlclVybCA9XG4gICAgICAgICh0eXBlb2Ygb3BlbklkSXNzdWVyQ29uZmlncyA9PT0gJ3N0cmluZycpID8gb3BlbklkSXNzdWVyQ29uZmlncyA6IG9wZW5JZElzc3VlckNvbmZpZ3MudXJsO1xuICAgIGNvbnN0IG9wZW5JZElzc3VlclBybXMgPVxuICAgICAgICAodHlwZW9mIG9wZW5JZElzc3VlckNvbmZpZ3MgPT09ICdzdHJpbmcnKSA/IG51bGwgOiBvcGVuSWRJc3N1ZXJDb25maWdzLnBybXM7XG5cbiAgICBjb25zdCBmdWxsVXJsID0gYCR7b3BlbklkSXNzdWVyVXJsfS8ke1dFTExfS05PV05fUEFUSH0vJHtPUEVOSURfQ09ORklHVVJBVElPTn0ke1xuICAgICAgICBvcGVuSWRJc3N1ZXJQcm1zID09IG51bGwgPyAnJyA6ICc/JyArIG9wZW5JZElzc3VlclBybXN9YDtcblxuICAgIGNvbnN0IHJlcXVlc3RvclRvVXNlID0gcmVxdWVzdG9yIHx8IG5ldyBKUXVlcnlSZXF1ZXN0b3IoKTtcblxuICAgIHJldHVybiByZXF1ZXN0b3JUb1VzZVxuICAgICAgICAueGhyPEF1dGhvcml6YXRpb25TZXJ2aWNlQ29uZmlndXJhdGlvbkpzb24+KHt1cmw6IGZ1bGxVcmwsIGRhdGFUeXBlOiAnanNvbicsIG1ldGhvZDogJ0dFVCd9KVxuICAgICAgICAudGhlbihqc29uID0+IG5ldyBBdXRob3JpemF0aW9uU2VydmljZUNvbmZpZ3VyYXRpb24oanNvbikpO1xuICB9XG59XG4iXX0=